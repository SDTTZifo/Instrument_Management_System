<form method="post" action="{% url 'login' %}">
    {% csrf_token %}

    {% if form.non_field_errors %}
        <div id="error-messages" class="alert alert-danger" style="display: none;">
            {{ form.non_field_errors }}
        </div>
    {% endif %}
    
    {{ form.username }}
    {{ form.password }}
    <button type="submit">Login</button>
</form>
<script>
    window.onload = function() {
        const errorMessages = document.getElementById('error-messages');
        // Check if the page was refreshed and only display error messages if not
        if (sessionStorage.getItem('refreshed') !== 'true' && errorMessages) {
            errorMessages.style.display = 'block';
        }
        // Remove the refresh flag after handling
        sessionStorage.removeItem('refreshed');
    };
</script>
<script>
    // Set a session storage flag if the page is being unloaded
    window.onbeforeunload = function () {
        sessionStorage.setItem('refreshed', 'true');
    };

    // Clear the flag on page load
    window.onload = function () {
        sessionStorage.removeItem('refreshed');
    };
</script>
